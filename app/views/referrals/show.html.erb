<% if @referral.user == current_user %>
  <div class="p-2 text-center alert alert-warning mb-0">
    <div class="center-box-max-width d-flex">
      <div class="mr-auto">
        <!-- <a class="btn btn-outline-secondary" href="<%= edit_offer_path @referral.uuid %>">Edit</a> -->
        <%= link_to "Delete", referral_path(@referral.uuid), method: :delete, data: { confirm: "Are you sure you want to delete this referral request?" }, class: "btn btn-link text-danger" %>
      </div>
    </div>
  </div>
<% end %>



<div class="text-center company-header bg-secondary p-4">
  <div class="text-white font-weight-light  mb-3">
    <h5><%= @referral.position %></h5>
    <h6><span class="fa fa-map-marker-alt"></span> <%= @referral.location %> </h6>
    <h6><%= @referral.yoe ? "#{@referral.yoe} YOE" : "" %></h6>
  </div>

  <div>
    <div class="mb-1">
      <a href="<%= company_path @referral.company.uuid %>" class="text-white"><img width="50px" class="img-thumbnail p-0 rounded" src="<%= @referral.company.logo_url %>"></a>
    </div>
    <h6 class="mb-3 text-white font-weight-light"><a href="<%= company_path @referral.company.uuid %>" class="text-white"><%= @referral.company.display_name %></a></h6>
  </div>

  <hr class="m-2" />

  <div>
    <div class="small text-light font-weight-light">
      <div>
        posted <%= time_ago_in_words @referral.created_at %> ago
      </div>
    </div>
  </div>
</div>


<div class="border-bottom p-3 bg-light">
  <div class="center-box-max-width">

    <div class="mb-3 sharethis-inline-share-buttons"></div>


    <div class="col-12 mb-3 mb-md-3">
      <div class="text-center card-shadow rounded bg-white p-2 p-md-3">
        <% if current_user == @referral.user %>
          <p class="text-justify">
            Your referral request is pending and
            <b><%= @referral.company.display_name %></b> employees will refer you very soon.
            We will disclose your <b>name, email, phone number</b> and <b>linkedin</b> to the person accepting your request.
          </p>

          <p class="small">
            If you change your mind and no longer want to be referred at <%= @referral.company.display_name %>, you can  <%= link_to "delete your request", referral_path(@referral.uuid), method: :delete, data: { confirm: "Are you sure you want to delete this referral request?" }, class: "text-danger" %>.
          </p>
        <% elsif @referral.company == current_user.company %>
          <p>
            This referral request is still pending... Take it now!
          </p>
          <p>
            The candidate's <b>name, email, phone number</b> and <b>linkedin</b> will be disclosed as soon as this request is unlocked.
          </p>
          <%= link_to "Unlock this referral", referral_path(@referral.uuid), method: :get, data: { confirm: "Not yet available, but we are working on it :)" }, class: "btn btn-danger" %>
        <% else %>
          <p>
            Unfortunately, only <b><%= @referral.company.display_name %></b> employees can unlock this referral.
          </p>
          <p>
            If you work at <b><%= @referral.company.display_name %></b> and want to refer this candidate, you will need to <a href="/signup" class="text-danger">signup with your work email</a>.
          </p>
          <p>
            Or, if you know someone at <b><%= @referral.company.display_name %></b>, you can send them this link:
            <div class="input-group">
              <input id="referralUrl" type="text" value="<%= referral_url(@referral.uuid) %>" class="form-control">
              <div class="input-group-append">
                <button type="button" class="btn btn-danger" onclick="copyToClipboard()">Copy</button>
              </div>
            </div>
          </p>

        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
  function copyToClipboard() {
    var copyText = document.getElementById('referralUrl');
    copyText.select();
    document.execCommand('copy');
  }
</script>
