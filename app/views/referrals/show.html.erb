<div class="container small">
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb bg-white mb-0">
      <li class="breadcrumb-item"><a href="/referrals">Referrals</a></li>
      <li class="breadcrumb-item active" aria-current="page"><%= @referral.og_title %></li>
    </ol>
  </nav>
</div>

<% if @referral.user == current_user %>
  <div class="p-2 text-center alert alert-warning mb-0">
    <div class="center-box-max-width d-flex">
      <div class="mr-auto">
        <!-- <a class="btn btn-outline-secondary" href="<%= edit_offer_path @referral.uuid %>">Edit</a> -->
        <%= link_to "Delete", referral_path(@referral.uuid), method: :delete, data: { confirm: "Are you sure you want to delete this referral request?" }, class: "btn btn-link text-danger" %>
      </div>
    </div>
  </div>
<% end %>



<div class="text-white company-header bg-secondary p-4">
  <div class="d-flex justify-content-center">
    <div class="mr-3">
      <a href="<%= company_path @referral.company.uuid %>">
        <div class="bg-white image-thumbnail-outer-lg rounded d-flex justify-content-center">
          <img class="align-self-center image-thumbnail-lg rounded" src="<%= @referral.company.logo_url %>" alt="<%= @referral.company.display_name %> logo">
        </div>
      </a>
    </div>

    <div>
      <div class="font-weight-light">
        <a href="<%= company_path @referral.company.uuid %>" class="text-white">
          <%= @referral.company.display_name %>
        </a>
      </div>
      <div class="lead font-weight-bold">
        <%= @referral.position %>
      </div>
      <div>
        <%= @referral.yoe ? "(#{@referral.yoe.to_i} YOE)" : "" %>
      </div>
      <div class="font-weight-light text-light">
        <span class="fa fa-map-marker-alt"></span> <%= @referral.location %>
      </div>
    </div>
  </div>

  <hr class="mt-3 mb-2" />

  <div class="text-center text-white">
    <% if @referral.job_posting_url.present? %>
      <div>
        <a href="<%= @referral.job_posting_url %>" title="Job posting url" target="_blank">Job posting <span class="fa fa-external-link"></span></a>
      </div>
    <% end %>
    <div class="small text-light font-weight-light">
      <div>
        posted <%= time_ago_in_words @referral.created_at %> ago
      </div>
    </div>
  </div>
</div>

<div class="border-bottom p-3 bg-light">
  <div class="center-box-max-width">

    <div class="mb-3 sharethis-inline-share-buttons"></div>

    <div class="col-12 mb-3 mb-md-3">
      <div class="card-shadow rounded bg-white p-3">
        <% if @referral.referrer %>
          <% if @referral.referrer == current_user %>
            <%= render partial: "referrals/referral_states/unlocked" %>
          <% elsif @referral.user == current_user %>
            <%= render partial: "referrals/referral_states/in_progress" %>
          <% else %>
            <%= render partial: "referrals/referral_states/taken" %>
          <% end %>
        <% elsif @referral.user == current_user %>
          <%= render partial: "referrals/referral_states/pending" %>
        <% elsif @referral.company == current_user&.company %>
          <%= render partial: "referrals/referral_states/available" %>
        <% else %>
          <%= render partial: "referrals/referral_states/unavailable" %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<script>
  function copyToClipboard() {
    var copyText = document.getElementById('referralUrl');
    copyText.select();
    document.execCommand('copy');
  }
</script>
